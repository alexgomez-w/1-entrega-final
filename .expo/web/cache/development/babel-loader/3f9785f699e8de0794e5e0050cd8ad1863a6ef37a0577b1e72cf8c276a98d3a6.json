{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState } from \"react\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport * as ImagePicker from \"expo-image-picker\";\nimport AddButton from \"../Components/AddButton\";\nimport { colors } from \"../Global/Colors\";\nimport * as MediaLibrary from \"expo-media-library\";\nimport { usePostProfileImageMutation } from \"../Services/shopServices\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { saveImage } from \"../Features/User/userSlice\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar ImageSelector = function ImageSelector(_ref) {\n  var navigation = _ref.navigation;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    image = _useState2[0],\n    setImage = _useState2[1];\n  var _usePostProfileImageM = usePostProfileImageMutation(),\n    _usePostProfileImageM2 = _slicedToArray(_usePostProfileImageM, 2),\n    triggerSaveImage = _usePostProfileImageM2[0],\n    resultSaveImage = _usePostProfileImageM2[1];\n  var dispatch = useDispatch();\n  var _useSelector = useSelector(function (state) {\n      return state.userReducer.value;\n    }),\n    localId = _useSelector.localId;\n  var verifyCameraPermissions = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      var _yield$ImagePicker$re = yield ImagePicker.requestCameraPermissionsAsync(),\n        granted = _yield$ImagePicker$re.granted;\n      if (!granted) {\n        return false;\n      }\n      return true;\n    });\n    return function verifyCameraPermissions() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var pickImage = function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      var isCameraOk = yield verifyCameraPermissions();\n      if (isCameraOk) {\n        var result = yield ImagePicker.launchCameraAsync({\n          mediaTypes: ImagePicker.MediaTypeOptions.All,\n          allowsEditing: true,\n          aspect: [1, 1],\n          quality: 1\n        });\n        console.log(result.assets);\n        if (!result.canceled) {\n          setImage(result.assets[0].uri);\n        }\n      }\n    });\n    return function pickImage() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var confirmImage = function () {\n    var _ref4 = _asyncToGenerator(function* () {\n      try {\n        var _yield$MediaLibrary$r = yield MediaLibrary.requestPermissionsAsync(),\n          status = _yield$MediaLibrary$r.status;\n        if (status === \"granted\") {\n          console.log(\"Only valid on emulators and physical devices\");\n          var response = yield MediaLibrary.createAssetAsync(image);\n          console.log(response.uri);\n          triggerSaveImage({\n            image: response.uri,\n            localId: localId\n          });\n          dispatch(saveImage(response.uri));\n        }\n      } catch (error) {\n        console.log(error);\n      }\n      navigation.goBack();\n    });\n    return function confirmImage() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  return _jsx(View, {\n    style: styles.container,\n    children: image ? _jsxs(_Fragment, {\n      children: [_jsx(Image, {\n        source: {\n          uri: image\n        },\n        style: styles.image\n      }), _jsx(AddButton, {\n        title: \"Take another photo\",\n        onPress: pickImage\n      }), _jsx(AddButton, {\n        title: \"Confirm photo\",\n        onPress: confirmImage\n      })]\n    }) : _jsxs(_Fragment, {\n      children: [_jsx(View, {\n        style: styles.noPhotoContainer,\n        children: _jsx(Text, {\n          children: \"No photo to show...\"\n        })\n      }), _jsx(AddButton, {\n        title: \"Take a photo\",\n        onPress: pickImage\n      })]\n    })\n  });\n};\nexport default ImageSelector;\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"flex-start\",\n    gap: 20,\n    marginTop: 20\n  },\n  image: {\n    width: 200,\n    height: 200\n  },\n  noPhotoContainer: {\n    width: 200,\n    height: 200,\n    borderWidth: 2,\n    borderColor: colors.red,\n    padding: 10,\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  }\n});","map":{"version":3,"names":["React","useState","Image","View","StyleSheet","Text","ImagePicker","AddButton","colors","MediaLibrary","usePostProfileImageMutation","useDispatch","useSelector","saveImage","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","ImageSelector","_ref","navigation","_useState","_useState2","_slicedToArray","image","setImage","_usePostProfileImageM","_usePostProfileImageM2","triggerSaveImage","resultSaveImage","dispatch","_useSelector","state","userReducer","value","localId","verifyCameraPermissions","_ref2","_asyncToGenerator","_yield$ImagePicker$re","requestCameraPermissionsAsync","granted","apply","arguments","pickImage","_ref3","isCameraOk","result","launchCameraAsync","mediaTypes","MediaTypeOptions","All","allowsEditing","aspect","quality","console","log","assets","canceled","uri","confirmImage","_ref4","_yield$MediaLibrary$r","requestPermissionsAsync","status","response","createAssetAsync","error","goBack","style","styles","container","children","source","title","onPress","noPhotoContainer","create","flex","alignItems","justifyContent","gap","marginTop","width","height","borderWidth","borderColor","red","padding"],"sources":["C:/Users/alexander.gomez/projects/clonados/CODERHOUSE/1-entrega-final/src/Screens/ImageSelector.jsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { Image, View, StyleSheet, Text } from \"react-native\";\nimport * as ImagePicker from \"expo-image-picker\";\nimport AddButton from \"../Components/AddButton\";\nimport { colors } from \"../Global/Colors\";\nimport * as MediaLibrary from \"expo-media-library\";\nimport { usePostProfileImageMutation } from \"../Services/shopServices\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { saveImage } from \"../Features/User/userSlice\";\n\nconst ImageSelector = ({ navigation }) => {\n    const [image, setImage] = useState(null);\n\n    const [triggerSaveImage, resultSaveImage] = usePostProfileImageMutation();\n    const dispatch = useDispatch();\n    const { localId } = useSelector((state) => state.userReducer.value);\n\n    const verifyCameraPermissions = async () => {\n        const { granted } = await ImagePicker.requestCameraPermissionsAsync();\n        if (!granted) {\n            return false;\n        }\n        return true;\n    };\n\n    const pickImage = async () => {\n\n        //Permission for camera\n        const isCameraOk = await verifyCameraPermissions();\n\n        if (isCameraOk) {\n            // No permissions request is necessary for launching the image library\n            let result = await ImagePicker.launchCameraAsync({\n                mediaTypes: ImagePicker.MediaTypeOptions.All,\n                allowsEditing: true,\n                aspect: [1, 1],\n                //base64: true,\n                quality: 1,\n            });\n\n            console.log(result.assets);\n\n            if (!result.canceled) {\n                setImage(result.assets[0].uri);\n            }\n        }\n    };\n\n    const confirmImage = async () => {\n        try {\n            // Request device storage access permission\n            const { status } = await MediaLibrary.requestPermissionsAsync();\n            if (status === \"granted\") {\n                console.log(\"Only valid on emulators and physical devices\");\n                // Save image to media library and create an asset\n                const response = await MediaLibrary.createAssetAsync(image);\n                console.log(response.uri);\n                //Save image link on profileImages remote location\n                triggerSaveImage({\n                    image: response.uri,\n                    localId: localId,\n                });\n                // Set image on redux state\n                dispatch(saveImage(response.uri));\n            }\n        } catch (error) {\n            console.log(error);\n        }\n        navigation.goBack();\n    };\n\n    return (\n        <View style={styles.container}>\n            {image ? (\n                <>\n                    <Image source={{ uri: image }} style={styles.image} />\n                    <AddButton title=\"Take another photo\" onPress={pickImage} />\n                    <AddButton title=\"Confirm photo\" onPress={confirmImage} />\n                </>\n            ) : (\n                <>\n                    <View style={styles.noPhotoContainer}>\n                        <Text>No photo to show...</Text>\n                    </View>\n                    <AddButton title=\"Take a photo\" onPress={pickImage} />\n                </>\n            )}\n        </View>\n    );\n};\n\nexport default ImageSelector;\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n        alignItems: \"center\",\n        justifyContent: \"flex-start\",\n        gap: 20,\n        marginTop: 20,\n    },\n    image: {\n        width: 200,\n        height: 200,\n    },\n    noPhotoContainer: {\n        width: 200,\n        height: 200,\n        borderWidth: 2,\n        borderColor: colors.red,\n        padding: 10,\n        justifyContent: \"center\",\n        alignItems: \"center\",\n    },\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}